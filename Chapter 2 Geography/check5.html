<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>破妄确认 5 · 证据链收集</title>

  <style>
    body{margin:0;background:#0b0f19;color:#e8eefc;font-family:system-ui,-apple-system,"PingFang SC","Microsoft YaHei",sans-serif}
    .wrap{max-width:860px;margin:0 auto;padding:16px;display:grid;gap:14px}
    .card{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);border-radius:18px;padding:18px}
    .title{font-size:20px;font-weight:900;margin:0 0 6px}
    .desc{opacity:.86;line-height:1.7;margin:0 0 10px}
    .pill{display:inline-block;font-size:12px;opacity:.85;border:1px solid rgba(255,255,255,.14);padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.04)}
    .grid{display:grid;gap:10px;margin-top:10px}
    .rune{
      border:1px solid rgba(255,255,255,.14);
      background:rgba(0,0,0,.18);
      border-radius:16px;
      padding:12px 12px;
      cursor:pointer;
      user-select:none;
      display:flex;
      gap:10px;
      align-items:flex-start;
      transition:.08s ease;
      line-height:1.6;
    }
    .rune:hover{transform:translateY(-1px);border-color:rgba(255,255,255,.28)}
    .rune input{margin-top:4px}
    .rune.ok{background:rgba(16,185,129,.18);border-color:rgba(16,185,129,.55)}
    .rune.bad{background:rgba(239,68,68,.18);border-color:rgba(239,68,68,.55)}
    .msg{min-height:28px;margin-top:12px;line-height:1.7;opacity:.92}
    .okBox{background:rgba(16,185,129,.20);border:1px solid rgba(16,185,129,.55);padding:10px 12px;border-radius:14px}
    .badBox{background:rgba(239,68,68,.20);border:1px solid rgba(239,68,68,.55);padding:10px 12px;border-radius:14px}
    .actions{display:flex;gap:10px;margin-top:12px}
    button{flex:1;padding:12px 14px;border-radius:14px;border:0;cursor:pointer;font-weight:900;background:rgba(255,255,255,.85);color:#0b0f19}
    button.ghost{background:rgba(255,255,255,.10);color:#e8eefc;border:1px solid rgba(255,255,255,.16)}
    button:disabled{opacity:.45;cursor:not-allowed}
    .hint{opacity:.86}
    .small{font-size:12px;opacity:.82}
  </style>
</head>

<body>
<div class="wrap">
  <div class="card">
    <div class="title">破妄确认 · 证据链收集</div>
    <div class="desc">
      你已立誓“大陆并非静止”。现在请收集能支撑这一誓言的 <b>证据符文</b>。<br>
      <span class="pill">多选</span>
      <span class="pill">目标：选对关键证据，不选干扰项</span>
    </div>

    <div class="grid" id="grid"></div>

    <div class="msg" id="msg"></div>

    <div class="actions">
      <button class="ghost" id="reset">清空选择</button>
      <button id="submit">结印校验</button>
    </div>

    <div class="actions" style="margin-top:10px">
      <button id="continue" disabled>结印完成 · 进入证据链下一层</button>
    </div>

    <div class="small hint" style="margin-top:10px">
      提示：真正的证据必须能解释“大陆曾经相连/发生移动”，而不是与地球日常现象有关。
    </div>
  </div>
</div>

<script>
  const params = new URLSearchParams(location.search);
  const nextSlide = parseInt(params.get("next") || "12", 10);

  // ✅ 关键证据（你可按你PPT内容调整）
  // 这里选 3 个最经典的：海岸线、化石、岩层/山脉
  const runes = [
    { id:"r1", title:"符文·形场合契（海岸线吻合）", text:"南美洲东岸与非洲西岸轮廓相似，可“拼合”。", good:true },
    { id:"r2", title:"符文·化石同源", text:"两地发现相同或相似的古生物化石分布。", good:true },
    { id:"r3", title:"符文·岩层同脉（或山脉走向一致）", text:"两地岩层性质、古老山脉走向存在对应关系。", good:true },

    // 干扰项（无关证据）
    { id:"r4", title:"干扰·昼夜交替", text:"白天黑夜每天变化。", good:false },
    { id:"r5", title:"干扰·四季变化", text:"一年四季更替。", good:false },
  ];

  const grid = document.getElementById("grid");
  const msg = document.getElementById("msg");
  const btnSubmit = document.getElementById("submit");
  const btnReset = document.getElementById("reset");
  const btnContinue = document.getElementById("continue");

  function render(){
    grid.innerHTML = "";
    runes.forEach(r=>{
      const div = document.createElement("div");
      div.className = "rune";
      div.innerHTML = `
        <input type="checkbox" id="${r.id}" />
        <div>
          <div style="font-weight:900">${r.title}</div>
          <div style="opacity:.86">${r.text}</div>
        </div>
      `;
      div.onclick = (e)=>{
        // 让点击卡片也能勾选
        if(e.target.tagName.toLowerCase() !== "input"){
          const cb = div.querySelector("input");
          cb.checked = !cb.checked;
        }
      };
      grid.appendChild(div);
    });
  }

  function clearMarks(){
    [...grid.children].forEach(x=>x.classList.remove("ok","bad"));
  }

  btnReset.onclick = ()=>{
    runes.forEach(r=>document.getElementById(r.id).checked = false);
    clearMarks();
    msg.innerHTML = "";
    btnContinue.disabled = true;
  };

  btnSubmit.onclick = ()=>{
    clearMarks();
    const chosen = runes.filter(r=>document.getElementById(r.id).checked);
    const chosenGood = chosen.filter(r=>r.good);
    const chosenBad = chosen.filter(r=>!r.good);

    // 通过条件：3 个关键证据全部选中，且不要选任何干扰项
    const pass = (chosenGood.length === 3 && chosenBad.length === 0);

    // 视觉标记
    runes.forEach((r, idx)=>{
      const checked = document.getElementById(r.id).checked;
      const card = grid.children[idx];
      if(!checked) return;
      card.classList.add(r.good ? "ok" : "bad");
    });

    if(pass){
      msg.innerHTML = `<div class="okBox">✅ 结印完成：证据链闭合。<br>
        你收集到的三枚证据符文共同指向：大陆曾经相连，并发生过移动。<br>
        下一步：进入“机制层”——看看是什么力量让板块移动。</div>`;
      btnContinue.disabled = false;
    }else{
      const missing = runes.filter(r=>r.good && !document.getElementById(r.id).checked).map(r=>r.title);
      msg.innerHTML = `<div class="badBox">❌ 证据链未闭合。<br>
        ${chosenBad.length ? "你选中了干扰项（与漂移无关），请取消它们。<br>" : ""}
        ${missing.length ? "你还缺少关键证据：<br><b>" + missing.join("、") + "</b>" : "再检查一次你选择的证据是否真正支持“漂移”。"}
      </div>`;
      btnContinue.disabled = true;
    }
  };

  btnContinue.onclick = ()=>{
    location.href = `index.html#s=${nextSlide}`;
  };

  render();
</script>
</body>
</html>
